数据集分发工作按流程分为三项：

1.定期基于已有数据集列表更新数据，目前周期：1个月
a.更新方法：将当前数据集列表文件（在上一次备份记录中获取）放在dataset_update文件夹下，update_dataset_list.py的OLD_LIST_DIR设置为该文件名，并设置更新起始时间DATE_FROM，运行update_dataset_list.py，即可自动生成最新数据集列表；
b.备份记录：每次更新后在dataset_update文件夹下创建新目录，命名为最新更新的日期，例如在10月31日更新了列表，则为：10_31_2019，将输入列表与输出的新新列表共同存入，方便日后核对与使用

关于update_dataset_list.py的具体每一步说明可参见update_dataset_list.ipynb中的使用说明



2.基于列表进行数据集下载
a.首先对每次更新的列表中无GSE号的手动查询添加
b.对每批数据进行下载前，根据GSE查询该数据集，确定为单细胞转录组测序数据，非单细胞直接删除，单细胞其他组学的添加标注‘单细胞非转录组’便于日后使用，最后只将确定为单细胞转录组的GSE编号用于下一步下载
c.在dataset_download文件夹下，将本次下载的数据集的GSE号列表填入test_downloading.py的GSE_CODE，在当前路径下运行nohup python3 test_downloading.py &
d.下载好的数据将存入test_downloading.py中写定的文件夹下，当前为'/home/biodb/data/user_admin/unallocated_data'

部分数据过大，在下载时会出现失败情况，因此建议优先下载小数据集



3.记录数据集状态
这一部分文件在dataset_record目录下，主要记录：
a.每一次下载的数据编号在进行下载前进行记录，下载之后，下载失败待重试的编号和下载成功的编号分开记录；
b.在对下载成功的数据分发后，将编号从下载成功中移入已分发
c.在这过程中任何数据有问题，则移入对应的记录条目（非单细胞、单细胞非转录组、单细胞转录组格式异常）中以便日后查询
d.尝试几次无法下载的数据，记入下载失败，待日后统一处理

具体分发：user请求数据集，将下载好的数据移入其目录下，分发前注意根据分发记录的总表检查是否重复（尽管下载时已去重，但此处复检），分发后记录分发的数据集

注：
以上为服务器上所有流程与记录，分发员同时在本地会有三个文件对应以上记录：分发总记录表，每周分发记录表，数据集信息总表，每个数据集状态发生改变时服务器端与本地文件均要同步记录状态

定义：数据集状态：未下载（无任何标注），下载成功，下载失败，是否分发，以及非单细胞（定期删除此状态数据）、单细胞非转录组、单细胞转录组格式异常